{% extends "base.html" %}

{% block title %}{{ exercise.title }} - Python Learning{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h3>{{ exercise[1] }}</h3>
                <span class="badge bg-primary">B√†i t·∫≠p</span>
            </div>
            <div class="card-body">
                <div class="exercise-content">
                    {{ exercise[2] | replace('\n', '<br>') | safe }}
                </div>
                
                <div class="mt-3">
                    <a href="{{ url_for('exercises') }}" class="btn btn-secondary btn-sm">‚Üê Quay l·∫°i</a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h4>üíª Th·ª±c h√†nh</h4>
            </div>
            <div class="card-body">
                <textarea id="exercise-code" class="form-control mb-3" rows="12" placeholder="# Vi·∫øt code Python c·ªßa b·∫°n ·ªü ƒë√¢y\nprint('Hello Python!')"></textarea>
                <button onclick="runExercise()" class="btn btn-success mb-3">‚ñ∂Ô∏è Ch·∫°y code</button>
                <div id="exercise-output" class="bg-dark text-light p-3 rounded" style="min-height: 150px; font-family: monospace;">
                    K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function runExercise() {
    const code = document.getElementById('exercise-code').value;
    const output = document.getElementById('exercise-output');
    
    output.innerHTML = 'ƒêang ch·∫°y...';
    
    fetch('/run_code', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({code: code})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            output.innerHTML = data.output || 'Code ch·∫°y th√†nh c√¥ng (kh√¥ng c√≥ output)';
        } else {
            output.innerHTML = `<span style="color: #ff6b6b;">L·ªói: ${data.error}</span>`;
        }
    })
    .catch(error => {
        output.innerHTML = `<span style="color: #ff6b6b;">L·ªói k·∫øt n·ªëi: ${error}</span>`;
    });
}


</script>
{% endblock %}