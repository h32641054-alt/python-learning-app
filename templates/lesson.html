{% extends "base.html" %}

{% block title %}{{ lesson.title }} - Python Learning{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h2>{{ lesson.title }}</h2>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="{{ url_for('home') }}">Trang ch·ªß</a></li>
                        <li class="breadcrumb-item"><a href="{{ url_for('course') }}">Kh√≥a h·ªçc</a></li>
                        <li class="breadcrumb-item active">{{ lesson.title }}</li>
                    </ol>
                </nav>
            </div>
            <div class="card-body">
                <div class="lesson-content">
                    {{ lesson.content | safe }}
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h4>üíª Th·ª±c h√†nh</h4>
            </div>
            <div class="card-body">
                <p>H√£y th·ª≠ ch·∫°y ƒëo·∫°n code n√†y:</p>
                <textarea id="exercise-code" class="form-control mb-3" rows="6">{{ lesson.exercise }}</textarea>
                <button onclick="runExercise()" class="btn btn-success mb-3">‚ñ∂Ô∏è Ch·∫°y code</button>
                <div id="exercise-output" class="bg-dark text-light p-3 rounded" style="min-height: 100px; font-family: monospace;">
                    K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...
                </div>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h4>üéØ M·ª•c ti√™u b√†i h·ªçc</h4>
            </div>
            <div class="card-body">
                <ul>
                    <li>Hi·ªÉu kh√°i ni·ªám c∆° b·∫£n</li>
                    <li>Th·ª±c h√†nh v·ªõi v√≠ d·ª•</li>
                    <li>√Åp d·ª•ng v√†o b√†i t·∫≠p</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="mt-4">
    <a href="{{ url_for('course') }}" class="btn btn-secondary">‚Üê Quay l·∫°i kh√≥a h·ªçc</a>
    <a href="{{ url_for('practice') }}" class="btn btn-primary">Th·ª±c h√†nh th√™m ‚Üí</a>
</div>
{% endblock %}

{% block scripts %}
<script>
function runExercise() {
    const code = document.getElementById('exercise-code').value;
    const output = document.getElementById('exercise-output');
    
    output.innerHTML = 'ƒêang ch·∫°y...';
    
    fetch('/run_code', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({code: code})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            output.innerHTML = data.output || 'Code ch·∫°y th√†nh c√¥ng (kh√¥ng c√≥ output)';
        } else {
            output.innerHTML = `<span style="color: #ff6b6b;">L·ªói: ${data.error}</span>`;
        }
    })
    .catch(error => {
        output.innerHTML = `<span style="color: #ff6b6b;">L·ªói k·∫øt n·ªëi: ${error}</span>`;
    });
}
</script>
{% endblock %}