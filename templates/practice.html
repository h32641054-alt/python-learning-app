{% extends "base.html" %}

{% block title %}Th·ª±c h√†nh Python - Python Learning{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">üíª Th·ª±c h√†nh Python</h1>
        <p class="lead">Vi·∫øt v√† ch·∫°y code Python ngay tr√™n tr√¨nh duy·ªát</p>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h4>üìù Code Editor</h4>
                <div>
                    <button onclick="clearCode()" class="btn btn-sm btn-outline-secondary">X√≥a</button>
                    <button onclick="loadExample()" class="btn btn-sm btn-outline-info">V√≠ d·ª•</button>
                </div>
            </div>
            <div class="card-body p-0">
                <textarea id="code-editor" class="form-control border-0" rows="20" placeholder="# Vi·∫øt code Python c·ªßa b·∫°n ·ªü ƒë√¢y
print('Xin ch√†o Python!')

# V√≠ d·ª•: T√≠nh t·ªïng hai s·ªë
a = 10
b = 20
tong = a + b
print(f'T·ªïng c·ªßa {a} v√† {b} l√†: {tong}')">print('Xin ch√†o Python!')

# V√≠ d·ª•: T√≠nh t·ªïng hai s·ªë
a = 10
b = 20
tong = a + b
print(f'T·ªïng c·ªßa {a} v√† {b} l√†: {tong}')</textarea>
            </div>
            <div class="card-footer">
                <button onclick="runCode()" class="btn btn-success">‚ñ∂Ô∏è Ch·∫°y code</button>
                <small class="text-muted ms-3">Nh·∫•n Ctrl+Enter ƒë·ªÉ ch·∫°y nhanh</small>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h4>üì∫ K·∫øt qu·∫£</h4>
            </div>
            <div class="card-body">
                <div id="output" class="bg-dark text-light p-3 rounded" style="min-height: 400px; font-family: monospace; white-space: pre-wrap;">
K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...

H√£y vi·∫øt code Python v√† nh·∫•n "Ch·∫°y code" ƒë·ªÉ xem k·∫øt qu·∫£!
                </div>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5>üí° G·ª£i √Ω b√†i t·∫≠p</h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    <button class="list-group-item list-group-item-action" onclick="loadExercise(1)">
                        1. In ra "Hello World"
                    </button>
                    <button class="list-group-item list-group-item-action" onclick="loadExercise(2)">
                        2. T√≠nh di·ªán t√≠ch h√¨nh ch·ªØ nh·∫≠t
                    </button>
                    <button class="list-group-item list-group-item-action" onclick="loadExercise(3)">
                        3. Ki·ªÉm tra s·ªë ch·∫µn l·∫ª
                    </button>
                    <button class="list-group-item list-group-item-action" onclick="loadExercise(4)">
                        4. V√≤ng l·∫∑p in s·ªë t·ª´ 1 ƒë·∫øn 10
                    </button>
                    <button class="list-group-item list-group-item-action" onclick="loadExercise(5)">
                        5. T√≠nh giai th·ª´a
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function runCode() {
    const code = document.getElementById('code-editor').value;
    const output = document.getElementById('output');
    
    output.innerHTML = 'ƒêang ch·∫°y code...';
    
    fetch('/run_code', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({code: code})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            output.innerHTML = data.output || 'Code ch·∫°y th√†nh c√¥ng (kh√¥ng c√≥ output)';
        } else {
            output.innerHTML = `‚ùå L·ªói:\n${data.error}`;
        }
    })
    .catch(error => {
        output.innerHTML = `‚ùå L·ªói k·∫øt n·ªëi: ${error}`;
    });
}

function clearCode() {
    document.getElementById('code-editor').value = '';
    document.getElementById('output').innerHTML = 'Code ƒë√£ ƒë∆∞·ª£c x√≥a. H√£y vi·∫øt code m·ªõi!';
}

function loadExample() {
    const example = `# V√≠ d·ª•: Ch∆∞∆°ng tr√¨nh qu·∫£n l√Ω danh s√°ch h·ªçc sinh
students = []

def add_student(name, age):
    student = {"name": name, "age": age}
    students.append(student)
    print(f"ƒê√£ th√™m h·ªçc sinh: {name}")

def show_students():
    print("\\nDanh s√°ch h·ªçc sinh:")
    for i, student in enumerate(students, 1):
        print(f"{i}. {student['name']} - {student['age']} tu·ªïi")

# Th√™m m·ªôt s·ªë h·ªçc sinh
add_student("Nguy·ªÖn VƒÉn A", 20)
add_student("Tr·∫ßn Th·ªã B", 19)
add_student("L√™ VƒÉn C", 21)

# Hi·ªÉn th·ªã danh s√°ch
show_students()`;
    
    document.getElementById('code-editor').value = example;
}

function loadExercise(num) {
    const exercises = {
        1: '# B√†i t·∫≠p 1: In ra "Hello World"\nprint("Hello World")',
        2: `# B√†i t·∫≠p 2: T√≠nh di·ªán t√≠ch h√¨nh ch·ªØ nh·∫≠t
length = 5
width = 3
area = length * width
print(f"Di·ªán t√≠ch h√¨nh ch·ªØ nh·∫≠t: {area}")`,
        3: `# B√†i t·∫≠p 3: Ki·ªÉm tra s·ªë ch·∫µn l·∫ª
number = 15
if number % 2 == 0:
    print(f"{number} l√† s·ªë ch·∫µn")
else:
    print(f"{number} l√† s·ªë l·∫ª")`,
        4: `# B√†i t·∫≠p 4: V√≤ng l·∫∑p in s·ªë t·ª´ 1 ƒë·∫øn 10
for i in range(1, 11):
    print(f"S·ªë: {i}")`,
        5: `# B√†i t·∫≠p 5: T√≠nh giai th·ª´a
def factorial(n):
    if n == 0 or n == 1:
        return 1
    else:
        return n * factorial(n - 1)

number = 5
result = factorial(number)
print(f"Giai th·ª´a c·ªßa {number} l√†: {result}")`
    };
    
    document.getElementById('code-editor').value = exercises[num];
}

// Shortcut Ctrl+Enter ƒë·ªÉ ch·∫°y code
document.getElementById('code-editor').addEventListener('keydown', function(e) {
    if (e.ctrlKey && e.key === 'Enter') {
        e.preventDefault();
        runCode();
    }
});
</script>
{% endblock %}